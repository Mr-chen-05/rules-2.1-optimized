# 📋 MCP工具安装脚本使用说明

> **🚀 安装前必读**：如果您还不了解MCP工具的价值和作用，请先阅读 **[🎯 什么是MCP工具？为什么要使用它们？](../docs/MCP-TOOLS-INTRODUCTION.md)**
>
> **🎯 目标**：提供多种MCP工具安装方式，确保在不同环境下都能成功安装
>
> **📅 更新日期**: 2025年8月4日

## 📖 概述

本目录包含多个MCP工具安装脚本，适用于不同的使用场景和技术水平。

**💡 重要提醒**：安装前建议先了解 [MCP工具的价值和作用](../docs/MCP-TOOLS-INTRODUCTION.md)，这样您就能明白为什么值得花15分钟安装这些工具。

**🎯 适合人群：**
- ✅ **新手用户** - 需要简单的一键安装
- ✅ **高级用户** - 需要自定义安装选项
- ✅ **企业用户** - 需要批量部署和管理
- ✅ **故障排除用户** - 其他安装方式失败，需要备选方案

## 🚀 自动安装MCP工具方法

### **方法一：点击 run-powershell-installer.bat 脚本（推荐）**

这是最简单、最可靠的安装方式，完美解决了编码问题和执行策略问题。

#### **🚀 npm 镜像源切换教程（解决后端依赖安装慢问题）**

**🤔 为什么后端开发更需要切换镜像源？**

- 📦 **依赖包多** - 后端项目通常依赖包更多，下载时间长
- 🏗️ **微服务架构** - 多个服务需要频繁安装依赖
- 🛠️ **开发工具** - 需要安装各种开发和构建工具
- 🚀 **CI/CD 流程** - 自动化部署需要快速安装依赖

**🔥 方法 1：使用小满 zs 工具包（推荐）**

感谢：本教程基于哔哩哔哩小满 zs 的工具包，原创教程来源于小满 zs。

**步骤 1：安装小满 zs 工具包**
```bash
# 全局安装小满zs工具包
npm i xmzs -g
```

**步骤 2：使用 mmp 命令管理镜像源**
```bash
# 安装完成后，会生成一个mmp命令
mmp
```

**步骤 3：选择淘宝镜像源**
运行 `mmp` 命令后，会显示镜像源列表：

- 使用方向键选择 **taobao（淘宝镜像）**
- 按回车键确认选择

**步骤 4：验证切换成功**
```bash
# 查看当前镜像源
npm config get registry

# 应该显示：https://registry.npmmirror.com/
# 注意：这是淘宝镜像的新域名，旧域名 registry.npm.taobao.org 已停用
```

**🔧 方法 2：手动切换镜像源**

**切换到淘宝镜像（推荐后端开发）：**
```bash
# 淘宝镜像新域名（推荐）
npm config set registry https://registry.npmmirror.com
```

**恢复官方镜像：**
```bash
npm config set registry https://registry.npmjs.org/
```

#### **安装步骤：**

**步骤1：切换镜像源（推荐）**
- 按照上面的教程切换到淘宝镜像源
- 这样可以大大提高安装速度

**步骤2：执行安装**

**详细操作步骤：**
1. **打开文件管理器**
   - 按 `Win + E` 打开文件资源管理器
   - 或者点击任务栏上的文件夹图标

2. **导航到脚本所在文件夹**
   - 在地址栏中输入或粘贴你的mcp-scripts文件夹路径
   - 例如：`E:\AgentRules\English\rules-2.1-optimized-2.3.0\mcp-scripts`
   - 按回车键进入该文件夹

3. **找到并双击脚本文件**
   - 在文件夹中找到 `run-powershell-installer.bat` 文件
   - **双击该文件**（不要右键，直接双击）

4. **脚本会自动执行以下操作**：
   - 🔧 设置UTF-8编码，解决中文乱码问题
   - 🛡️ 处理PowerShell执行策略问题
   - 🚀 调用主安装脚本 `install-mcp-tools-enhanced-final.ps1`
   - 📊 显示详细的安装过程和结果
   - ✅ 自动验证所有MCP工具的安装状态
   - 📝 **自动生成配置文件** `mcp-config.json` 在MCP-Tools文件夹下

**步骤3：按提示操作**
- 选择安装盘符（默认D盘，推荐选择有足够空间的盘符）
- 等待安装完成（约需要100MB空间）
- 查看安装报告，确认所有5个工具都安装成功

**✅ 安装成功标志：**
- 显示 "Installed tools count: 5/5"
- 生成格式化的 `mcp-config.json` 配置文件
- 所有工具验证通过

---

### **方法二：手动在PowerShell命令面板执行**

适合熟悉PowerShell的高级用户，需要手动处理执行策略。

#### **安装步骤：**

**步骤1：获取脚本绝对路径**
1. 找到 `install-mcp-tools-enhanced-final.ps1` 文件
2. 右键点击该文件，选择"属性"
3. 在"安全"选项卡下面，"对象名称"显示的就是文件的绝对路径
4. 复制这个绝对路径

**步骤2：打开PowerShell**

**⚠️ 如果你的系统没有PowerShell：**
> **重要提醒**：如果你的Windows系统没有安装PowerShell，请先下载安装：
> 
> **下载地址**：https://github.com/PowerShell/PowerShell/releases
> 
> **安装步骤**：
> 1. 访问上述GitHub页面
> 2. 下载最新版本的 `PowerShell-x.x.x-win-x64.msi`
> 3. 双击安装包，按提示完成安装
> 4. 安装完成后重启电脑
> 5. 然后继续下面的步骤

**打开PowerShell的方法**：
- 按 `Win + X`，选择"Windows PowerShell"
- 或者按 `Win + R`，输入 `powershell`，按回车
- **注意：建议在PowerShell中执行，CMD中可能出现问题**

**步骤3：执行安装命令**
```powershell
# 使用以下命令格式，替换为你的实际文件路径
powershell -ExecutionPolicy Bypass -File "install-mcp-tools-enhanced-final.ps1的绝对路径"

# 示例（替换为你的实际路径）：
# 注意：如果项目在非C盘，PowerShell会自动处理盘符切换
powershell -ExecutionPolicy Bypass -File "E:\AgentRules\English\rules-2.1-optimized-2.3.0\mcp-scripts\install-mcp-tools-enhanced-final.ps1"
```

**⚠️ 不建议使用CMD执行：**
> **重要提醒**：我们**不建议**在CMD命令提示符中执行MCP安装脚本，原因如下：
> - ❌ **编码问题** - CMD对UTF-8支持不完善，容易出现中文乱码
> - ❌ **执行策略** - CMD无法正确处理PowerShell执行策略
> - ❌ **错误处理** - CMD的错误提示不够详细，难以排查问题
> - ❌ **兼容性** - 在不同Windows版本中表现不一致
>
> **推荐方案**：
> - ✅ **最佳选择** - 使用方法一：双击 `run-powershell-installer.bat`
> - ✅ **备选方案** - 使用方法二：在PowerShell中手动执行

**步骤4：按提示完成安装**
- 选择安装盘符（默认D盘，推荐选择有足够空间的盘符）
- 等待安装完成（约需要100MB空间）
- 查看安装结果和详细报告

**⚠️ 重要提醒：**
- **推荐**使用PowerShell而不是CMD
- 路径需要是绝对路径，不能是相对路径
- 如果路径包含空格，需要用双引号包围整个路径
- 如果遇到问题，优先使用方法一（双击脚本）

---

## 🔧 配置和使用

### **安装完成后的配置**

1. **查看安装结果**
   - 检查安装目录（如 `D:\MCP-Tools`）
   - 确认 `mcp-config.json` 文件已生成
   - 验证所有5个工具都已安装

2. **配置MCP工具**
   - 编辑 `mcp-config.json` 文件
   - 根据你的项目路径修改配置
   - 参考 `docs/MCP-DETAILED-CONFIG-GUIDE.md` 进行详细配置

3. **测试功能**
   - 重启你的AI工具（Claude、Cursor等）
   - 测试MCP工具是否正常工作

### **验证安装成功**

**Node.js MCP工具（4个）- 可在文件管理器中看到：**
```bash
# 检查安装目录
dir "D:\MCP-Tools\node_modules\@modelcontextprotocol"

# 应该看到以下4个文件夹：
# - server-filesystem
# - server-memory  
# - server-github
# - server-everything
```

**Python MCP工具（1个）- 无法在文件管理器中看到：**
```bash
# 验证mcp-feedback-enhanced（Python包）
uvx mcp-feedback-enhanced@latest version

# 应该显示类似：
# MCP Feedback Enhanced Enhanced v2.6.0
```

## 🐛 常见问题解决

### **问题1：PowerShell执行策略错误**
```
错误：无法加载文件，因为在此系统上禁止运行脚本
```
**解决方案：**
- **推荐**：使用方法一，双击 `run-powershell-installer.bat`（自动处理执行策略）
- 或者在PowerShell中手动设置：`Set-ExecutionPolicy -ExecutionPolicy Bypass -Scope CurrentUser`

### **问题2：编码问题导致乱码**
```
错误：显示乱码或"不是内部或外部命令"
```
**解决方案：**
- **推荐**：使用方法一，`run-powershell-installer.bat`（已解决编码问题）
- 脚本会自动设置UTF-8编码：`chcp 65001`

### **问题3：网络连接问题**
```
错误：npm install 失败或超时
```
**解决方案：**
```bash
# 切换npm镜像源到淘宝镜像
npm config set registry https://registry.npmmirror.com

# 然后重新运行安装脚本
```

### **问题4：权限问题**
```
错误：无法创建目录或写入文件
```
**解决方案：**
- 右键点击脚本，选择"以管理员身份运行"
- 或者选择有写入权限的安装路径（如D盘、E盘）

### **问题5：找不到文件路径**
```
错误：系统找不到指定的路径
```
**解决方案：**
- 确保使用绝对路径，不要使用相对路径
- 检查路径中是否有特殊字符或空格
- 使用双引号包围整个路径

## 📁 文件说明

### **主要脚本文件**
- `run-powershell-installer.bat` - PowerShell启动器（推荐使用）
- `install-mcp-tools-enhanced-final.ps1` - PowerShell主安装脚本

### **配置和文档**
- `安装脚本使用说明.md` - 本文件
- `mcp-config.json` - 安装后生成的配置文件（位于安装目录下）

### **两个脚本的配合关系**
- `run-powershell-installer.bat` 和 `install-mcp-tools-enhanced-final.ps1` 是配合使用的
- 批处理启动器负责处理编码和执行策略问题
- PowerShell脚本负责实际的安装逻辑
- 用户只需双击批处理文件即可完成整个安装过程

## 🎯 推荐使用流程

**新手用户（推荐）：**
1. 先切换npm镜像源到淘宝镜像（提高安装速度）
2. 双击 `run-powershell-installer.bat`
3. 按提示选择安装盘符
4. 等待安装完成

**高级用户：**
1. 先切换npm镜像源（如需要）
2. 使用方法二手动执行PowerShell脚本
3. 自定义安装路径和配置

**企业用户：**
1. 测试脚本在目标环境中的兼容性
2. 根据需要修改脚本参数
3. 批量部署到多台机器

## 📞 技术支持

如果遇到问题，请：
1. 查看本文档的常见问题部分
2. 检查系统环境（Node.js、Python版本）
3. 尝试不同的安装方式
4. 查看详细的错误日志

---

## 🚨 安装完成后必读

> **⚠️ 重要提醒**：安装脚本执行完成后，**强烈建议**完整阅读 **[📋 MCP工具详细配置指南](../docs/MCP-DETAILED-CONFIG-GUIDE.md)**！
>
> **🎯 为什么建议阅读？**
> - 📝 **配置文件是模板** - 生成的配置文件需要根据你的实际情况修改
> - 🔧 **路径需要调整** - MCP工具路径和项目路径需要改为你的实际路径
> - 🔑 **Token需要配置** - GitHub Token需要替换为你的真实Token
> - ✅ **验证安装结果** - 确保所有5个MCP工具都正确安装和配置
>
> **📋 不阅读配置指南的后果：**
> - ❌ MCP工具无法正常工作
> - ❌ AI助手无法访问你的项目文件
> - ❌ 智能反馈功能无法使用
> - ❌ 浪费安装时间，功能完全不可用

**🎉 安装成功后的必要步骤：**
1. **立即阅读** → [📋 MCP工具详细配置指南](../docs/MCP-DETAILED-CONFIG-GUIDE.md)
2. **修改配置文件** → 根据指南调整 `mcp-config.json`
3. **验证配置** → 确保所有路径和Token都正确
4. **测试功能** → 重启AI工具并测试MCP功能
